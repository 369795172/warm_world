# UI 展示效果升级计划（参考原型）

## 版本记录
- 版本：v0.2（2025-11-22）
- 修改说明：
  - 按世界观与产品框架补充“背景/目标/现状”结构
  - 区分当前实现与未来规划，强调参考原型属性
  - 统一术语：兴趣驱动、长期主义、真实因果、生命五循环

## 背景（世界观与产品框架对齐）
- 世界观原则：
  - 兴趣驱动优先、恐惧为边界（温柔但不说谎，减少惩罚性语言）
  - 时间与复利：长期主义（让孩子体验“慢慢长大”与积累）
  - 真实因果而非说教（通过环境与反馈呈现后果）
- 产品框架映射：
  - 生命五循环（价值创造/传递/交换/增长/选择与后果）在现有场景的映射：
    - HomeScene：玩具分享 → 价值传递/交换；心情反馈 → 选择与后果
    - GardenScene：种植与浇水 → 价值创造/增长；时间推进体现长期主义
    - TownView：探索动线 → 兴趣驱动与安全边界引导
- 定位与价值：
  - 面向 2–8 岁阶段的交互 MVP，提供一个温柔的导览与探险场景
  - 作为参考原型验证视觉与交互的可行路径，不对整体产品方向形成约束

## 目标
- 短期（MVP）：
  - 在不改变交互逻辑与行为记录的前提下，为 `Home/Garden/Town` 增加主题背景与轻量动效
  - 将人物（爸爸妈妈、小兔兔、小熊熊）与物品（小球、礼物、音乐盒）替换为可维护的 2D 资产（优先 SVG/Lottie）
  - 性能与可访问性达标：FPS ≥ 55、首屏 < 2s、交互响应 < 100ms、支持 `prefers-reduced-motion`
- 长期（为未来 App 提供参考）：
  - 形成按年龄段与环境维度（资源密度/规则透明度等）的可配置主题与动效规范
  - 建立资产降级策略（2D/3D/Emoji）与弱网/低端设备可用性保障
  - 为家长模式提供更清晰的观察视图与温柔提示（鼓励型声音）

## 现状（代码库客观描述）
- 技术栈与构建：React 18 + TypeScript + Vite + Tailwind；状态 `zustand`
- 关键组件：
  - Home 场景交互：`src/components/HomeScene.tsx`
  - 花园场景交互：`src/components/GardenScene.tsx`
  - 小镇导航入口：`src/components/TownView.tsx`
  - 家长模式：`src/components/ParentMode.tsx`
  - 时间与语音：`src/components/TimeManager.tsx`、`src/components/AudioManager.tsx`
  - 配置中心：`src/config/appConfig.ts`
- 已完成功能：
  - 场景切换、玩具拖拽/分享、植物生长与浇水、语音提示、时间管理、行为记录与简单统计
  - 背景元素与轻动效（基于 Tailwind/CSS 与少量动画类）
- 待完善部分：
  - 图形资产：人物/物品仍主要为 Emoji/图标，缺少统一的 2D 资产管线
  - 动效体系：缺少分层规范（入场/交互/背景）、降级与 `prefers-reduced-motion` 全流程守护
  - 资源管理：资产懒加载与分包策略未形成规范
  - QA/监控：缺少统一的性能与可访问性度量流程

## 技术选型（建议）
- 背景与轻量动效：CSS + Tailwind（渐变、噪声纹理、Parallax）；`framer-motion`（入场与交互反馈）
- 2D 资产：
  - 静态/少态：SVG（主题着色/无损缩放）
  - 中度动画：Lottie（Bodymovin JSON）
- 3D（可选）：`react-three-fiber` + `three.js` 加载低面 `glTF`，仅用于展示型交互，默认降级到 2D

## 资产管线与目录（建议）
- 目录：`public/assets/{characters|toys|backgrounds}`
- 命名：`bunny.svg|.json`、`bear.svg|.json`、`parent.svg|.json`、`ball.svg|.json`、`gift.svg|.json`、`music_box.svg|.json`
- 配置拓展（`src/config/appConfig.ts`）：增加 `assetType: 'emoji'|'svg'|'lottie'|'gltf'`、`assetSrc`、`themeColor`

## 组件改造策略（保持逻辑不变）
- 引入通用渲染器：`CharacterRenderer`、`ToyRenderer`（纯展示组件），按配置选择 SVG/Lottie/3D
- `HomeScene.tsx`：保留拖拽/分享与行为记录，仅替换渲染层与动效反馈
- `GardenScene.tsx`：替换种子与阶段视觉为 SVG/Lottie；加入天气/光斑背景动效；计时/浇水逻辑保持
- `TownView.tsx`：分层背景（远山/云层/前景植被），入口按钮加入轻动效与触感提示

## 动效规范与性能守护
- 动效时序：入场 200–400ms、交互反馈 100–150ms；使用 `transform/opacity` 避免布局抖动
- 资源加载：按需分包与懒加载；Lottie/GLTF 仅在需要时加载；SVG 优先
- 降级策略：检测 `prefers-reduced-motion` 与 FPS 探针，卡顿时自动关闭高强度动效与 3D

## 里程碑计划

### 第一阶段：基础架构与资产准备（1-2周）
**目标**：建立UI升级的技术基础和资产管理体系

**具体任务**：
1. **技术架构升级**
   - 集成 framer-motion 动画库
   - 配置 SVG 和 Lottie 加载器
   - 建立资产懒加载机制
   - 实现 prefers-reduced-motion 检测

2. **资产管理系统**
   - 创建 `public/assets/` 目录结构
   - 建立资产命名规范
   - 配置资产压缩和优化流程
   - 实现资产版本控制

3. **配置系统扩展**
   - 在 `appConfig.ts` 中添加资产类型配置
   - 实现主题色彩管理
   - 配置降级策略参数

**验收标准**：
- 所有依赖库正确安装并运行
- 资产加载无性能问题
- 配置系统可正常切换资产类型

### 第二阶段：核心组件视觉升级（2-3周）
**目标**：替换Emoji为2D资产，提升视觉体验

**具体任务**：
1. **TownView场景升级**
   - 创建分层背景（远山/云层/前景植被）
   - 设计场景入口按钮动效
   - 实现触感提示动画
   - 添加环境粒子效果

2. **HomeScene角色升级**
   - 创建角色SVG资产（小兔兔、小熊熊、爸爸妈妈）
   - 实现角色表情和动作动画
   - 添加分享交互的视觉反馈
   - 优化拖拽体验

3. **GardenScene植物升级**
   - 创建植物生长阶段SVG资产
   - 实现生长过程动画
   - 添加天气和光斑背景动效
   - 优化浇水交互效果

**验收标准**：
- 所有Emoji替换为2D资产
- 动画流畅度≥55FPS
- 交互响应时间<100ms

### 第三阶段：动效体系完善（1-2周）
**目标**：建立完整的动效规范和性能保障

**具体任务**：
1. **动效规范实现**
   - 入场动画：200-400ms
   - 交互反馈：100-150ms
   - 使用transform/opacity避免布局抖动

2. **性能优化**
   - 实现FPS监控
   - 自动降级机制
   - 资源分包策略
   - 内存使用优化

3. **可访问性保障**
   - prefers-reduced-motion完整支持
   - 提供动效开关
   - 优化色对比度

**验收标准**：
- Lighthouse性能评分≥85
- 低端设备流畅运行
- 可访问性测试通过

### 第四阶段：测试与优化（1周）
**目标**：确保升级后的UI稳定可靠

**具体任务**：
1. **全面测试**
   - 跨设备兼容性测试
   - 性能基准测试
   - 用户体验测试

2. **问题修复**
   - 修复发现的视觉问题
   - 优化性能瓶颈
   - 完善降级策略

3. **文档更新**
   - 更新开发文档
   - 记录最佳实践
   - 建立维护指南

**验收标准**：
- 无严重bug
- 性能指标达标
- 文档完整可用

## 验收与度量
- Lighthouse 性能 ≥ 85；内存稳定；低端设备降级有效；关键交互路径通过
- 明确声明：本文档与实现均为参考原型，不影响整体产品方向决策

## 风险与缓解
- 资产体积增长：矢量优先、动效压缩、分包与懒加载；移除未使用资产
- 设备差异：自动降级与关闭复杂动效；提供用户开关
- 风格统一与人力：优先 2D，3D 仅用于展示型亮点；建立轻量资产规范

## 时间估算
- **总工期**：5-8周
- **并行开发**：部分任务可并行进行
- **缓冲时间**：每阶段预留20%缓冲时间
- **里程碑评审**：每阶段结束后进行评审和调整
